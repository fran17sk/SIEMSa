{% extends 'proveedores/home.html' %}

{% block head %}
<style>
/* --- Contenedor principal --- */
.update-providers-container {

  margin: 60px;
  padding: 40px;
  background: #ffffff;
  color: #111827;
  border-radius: 16px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.08);
  font-family: 'Inter', sans-serif;
}

/* --- T√≠tulo --- */
.update-providers-container h2 {
  text-align: center;
  margin-bottom: 15px;
  font-size: 1.8rem;
  font-weight: 600;
  color: #1f2937;
}

.update-providers-container .warning {
  background-color: #FEF2F2; 
  border: 1px solid #FCA5A5;
  color: #991B1B;
  padding: 12px 16px;
  border-radius: 12px;
  margin-bottom: 25px;
  font-size: 0.95rem;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

/* --- √Årea drag & drop --- */
.drag-drop-area {
  border: 2px dashed #CBD5E1;
  border-radius: 14px;
  padding: 50px 20px;
  text-align: center;
  background: #f9fafb;
  transition: all 0.2s;
}

.drag-drop-area:hover {
  background: #f3f4f6;
  border-color: #3b82f6;
}

.drag-drop-area p {
  color: #4b5563;
  font-size: 0.95rem;
}

.drag-drop-area input[type="file"] {
  display: none;
}

/* --- Bot√≥n de env√≠o --- */
.upload-btn {
  margin-top: 25px;
  background-color: #3B82F6;
  color: #ffffff;
  border: none;
  padding: 14px 28px;
  font-size: 1rem;
  font-weight: 500;
  border-radius: 10px;
  cursor: pointer;
  width: 100%;
  transition: background 0.2s;
}

.upload-btn:hover {
  background-color: #2563EB;
}

/* --- Mensajes de estado --- */
.alert {
  margin-top: 25px;
  padding: 14px;
  border-radius: 10px;
  font-weight: 500;
  text-align: center;
  font-size: 0.95rem;
}
.alert-success {
  background-color: #ECFDF5;
  border: 1px solid #34D399;
  color: #065F46;
}
.alert-error {
  background-color: #FEF2F2;
  border: 1px solid #FCA5A5;
  color: #991B1B;
}
</style>
{% endblock %}

{% block content %}
<div class="update-providers-container">
  <h2>Actualizar Proveedores</h2>
  <p class="warning">
    ‚ö†Ô∏è Atenci√≥n: Los proveedores actuales en la base de datos ser√°n reescritos. 
    Cualquier cambio manual previo se perder√°.
  </p>

  <!-- Formulario de subida -->
  <form id="uploadForm" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="drag-drop-area" id="dragDropArea">
      <p>üìÇ Arrastr√° tu archivo Excel aqu√≠ o hac√© click para seleccionarlo</p>
      <input type="file" name="excel_file" id="excelFile" accept=".xlsx, .xls" />
    </div>

    <button type="submit" class="upload-btn">Actualizar Proveedores</button>
  </form>

  <!-- Mensajes de √©xito/error -->
  {% if messages %}
    {% for message in messages %}
      <div class="alert {% if message.tags == 'success' %}alert-success{% elif message.tags == 'error' %}alert-error{% endif %}">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}
</div>

<script>
const dragDropArea = document.getElementById('dragDropArea');
const fileInput = document.getElementById('excelFile');

// Click para abrir selector
dragDropArea.addEventListener('click', () => fileInput.click());

// Arrastrar y soltar
dragDropArea.addEventListener('dragover', e => {
  e.preventDefault();
  dragDropArea.style.background = '#E5E7EB';
});

dragDropArea.addEventListener('dragleave', e => {
  e.preventDefault();
  dragDropArea.style.background = '#f9fafb';
});

dragDropArea.addEventListener('drop', e => {
  e.preventDefault();
  dragDropArea.style.background = '#f9fafb';
  fileInput.files = e.dataTransfer.files;
  if(fileInput.files.length > 0){
    dragDropArea.querySelector('p').textContent = `üìÑ ${fileInput.files[0].name}`;
  }
});

// Mostrar nombre si se selecciona manualmente
fileInput.addEventListener('change', () => {
  if(fileInput.files.length > 0){
    dragDropArea.querySelector('p').textContent = `üìÑ ${fileInput.files[0].name}`;
  }
});
</script>
{% endblock %}
